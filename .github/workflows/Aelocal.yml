name: ETL Process for UAE Local Terrorist List

on:
  schedule:
    - cron: "0 0 * * *"  # Runs daily
  workflow_dispatch:  # Allows manual triggers

jobs:
  etl:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Set up Python 3.x
        uses: actions/setup-python@v2
        with:
          python-version: 3.x

      - name: Install Python dependencies
        run: |
          pip install pyicu plyvel xlrd normality zavod rigour nomenklatura
          pip install -e './zavod[dev]'

      - name: Run ETL Process (Crawl)
        run: |
          zavod crawl ./datasets/ae/local_terrorists/ae_local_terrorists.yml

      - name: Run ETL Export
        run: |
          zavod export ./datasets/ae/local_terrorists/ae_local_terrorists.yml

      - name: Save ETL Output to Repository
        run: |
          git config --global user.name "AnalyzeJayWhiz"
          git config --global user.email "jaymehta130@gmail.com"
          git add ./datasets/*
          git commit -m "Add ETL output"
          git push origin main
